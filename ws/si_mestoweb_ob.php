<?session_start();//$con=mysql_connect("localhost","root","");//mysql_select_db("doe",$con);'$link = mysqli_connect("localhost", "root", "password.1", "doe");include('config.php');include('Database.php');date_default_timezone_set('Asia/Jakarta');global $result;$result = array();$tanggal2 = date('Y-m-d H:i:s', time());if ( stristr($_SERVER["HTTP_ACCEPT"],"application/xml")) {  		header("Content-type: application/xml"); } else {  		header("Content-type: text/xml");}if ( stristr($_SERVER["HTTP_ACCEPT"],"application/xml")) {  		header("Content-type: application/xml"); } else {  		header("Content-type: text/xml");}function object2array($object) {    if (is_object($object)) {        foreach ($object as $key => $value) {            $array[$key] = $value;        }    }    else {        $array = $object;    }    return $array;}// proses insert to databasefunction getmaster($isi){	foreach ($isi as $key1 => $value1) {			$field 	.= $key1.",";					if  ($key1=='TANGGAL'){				$val   	.=  "'".substr($value1,4,4)."-".substr($value1,2,2)."-".substr($value1,0,2)."',";			}else{				$val   	.=  "'".$value1."'".",";			}			$ss	   	.= '"'.$key1.'"=>"'.$value1.'",';			//array_push($result, $ss);	}	$field 	= substr($field,0,strlen($field)-1);//tambahkan field	$val 	= substr($val,0,strlen($val)-1);//tambah isinya	$sql_m 	= "INSERT INTO dashboard_ptks ($field) VALUES ($val);";	$ss 	= substr($ss,0,strlen($ss)-1);	//array_push($result, $ss);		return $sql_m;} function getmaster1($isi1){	foreach ($isi1 as $key1 => $value1) {			$field .= $key1.",";			$val   .=  "'".$value1."'".",";	}	$field 	= substr($field,0,strlen($field)-1);//tambahkan field	$val 	= substr($val,0,strlen($val)-1);//tambah isinya	$sql_m 	= "INSERT INTO pr_item ($field) VALUES ($val);";	return $sql_m;} function logdata($xml){	$db 	= new Database();	$data1 = Array (			"tgl_trans" => date('YmdHis'),			"log_dt" => $xml		);	$db->insert ("log_data", $data1);}function SI_MESTOWEB_OB($data) {	$db 	= new Database();	$dataq  = object2array($data);		foreach ($data as $key => $value) {		if (is_object($value)){			$hsl	= getmaster($value);			//$qry	= mysql_query($xml);			//logdata('Hasil Header '.$hsl);		}elseif(is_array($value)){			foreach($value as $k => $v) {				if (is_object($v)){					$hsl	= getmaster($v);					logdata($hsl);					$db->query($hsl);					//mysqli_query($link,$hsl);					//logdata(print_r($hsl,true));					//$db->insert ("dashboard_ptks", $hsl);					//$qry	= mysql_query($xml);					//$hsl 	= mysql_query('INSERT INTO log_data (tgl_trans,log_dt) VALUES ("'.$tanggal2.'","'.$xml.'")');//=========================================================================================================================================================////=============================================================Array dimensi ke 3==========================================================================//					foreach ($v as $k1 => $v1) {						if (is_object($value)){							//$hsl	= getmaster1($v1);							//$qry	= mysql_query($xml);							//logdata($hsl);						}elseif(is_array($value)){							foreach($v1 as $k2 => $v2) {								if (is_object($v2)){									//$hsl	= getmaster1($v2);									//logdata($hsl);									//$qry	= mysql_query($xml);									//$hsl 	= mysql_query('INSERT INTO log_data (tgl_trans,log_dt) VALUES ("'.$tanggal2.'","isi1 - '.$v.' - '.$xml.'")');								}elseif(is_array($v2)){									logdata('data v2 '.$v2);									//$hsl 	= mysql_query('INSERT INTO log_data (tgl_trans,log_dt) VALUES ("'.$tanggal2.'","isi2 - Data ARRAY Dalam Array")');								}else{								}							}						}else{							//$hsl 	= mysql_query('INSERT INTO log_data (tgl_trans,log_dt) VALUES ("'.$tanggal2.'","isi3 - Data ARRAY Level II")');						}					}//==========================================================End Array dimensi ke 3=========================================================================////=========================================================================================================================================================//				}elseif(is_array($v)){					//$hsl 	= mysql_query('INSERT INTO log_data (tgl_trans,log_dt) VALUES ("'.$tanggal2.'","Data ARRAY Dalam Array")');				}else{				}			}		}else{			//$hsl 	= mysql_query('INSERT INTO log_data (tgl_trans,log_dt) VALUES ("'.$tanggal2.'","Data ARRAY Level I")');		}	}}//"========================= COnstructor ====================================$server = new SoapServer("SI_MESTOWEB_OB.wsdl");$server->addFunction("SI_MESTOWEB_OB");$server->handle();?>